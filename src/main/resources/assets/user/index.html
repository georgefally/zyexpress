<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>会员管理</title>
    <script src="../scripts/jquery/jquery.js"></script>
    <script src="../bootstrap-3.3.6/js/bootstrap.js"></script>
    <link href="../bootstrap-3.3.6/css/bootstrap.css" rel="stylesheet"/>
    <link href="../css/custom.css" rel="stylesheet"/>
</head>
<body>

<form id="userQueryForm" class="form-inline" method="post" onsubmit="return false;">
    <div class="row col-md-offset-2">
        <div class="form-group">
            <label>会员个人信息查询(只允许查询当前已登录的用户)</label>
            <input type="text" name="query_username" id="query_username" class="form-control" placeholder="用户名" value="">
            <input type="submit" name="query_submit" id="query_submit" class="form-control" value="查询">
        </div>
    </div>
</form>

<form id="userModifyPasswordForm" class="form-inline" method="post" onsubmit="return false;">
    <div class="row col-md-offset-2">
        <div class="form-group">
            <label>会员修改密码(只允许修改当前已登录的用户)</label>
            <input type="text" name="modify_password_new_password" id="modify_password_new_password"
                   class="form-control" placeholder="新密码" value="">
            <input type="submit" name="modify_password_submit" id="modify_password_submit" class="form-control" value="修改密码">
        </div>
    </div>
</form>

<h2>用户上传照片</h2>
<h2>管理员上传照片</h2>

<script>
    var login_token = sessionStorage.login_token;
    var login_user = sessionStorage.login_user;

    $("#query_submit").unbind("click").bind("click", function() {
        var data = $("#userQueryForm").serializeArray();//序列化表单
        $.ajax({
            type : "POST",
            contentType : "application/x-www-form-urlencoded",
            headers: {
                "Authorization": "Basic " + btoa(login_user + ":" + login_token)
            },
            url : "../restful/user/query",
            dataType : "json",
            data : data || "",
            success : function(data) {
                alert("User info: " + JSON.stringify(data.payload));
            },
            error : function(jqXHR, textStatus, errorThrown) {
                alert("User query failed, error: " + jqXHR.responseText);
            }
        });
    });

    $("#modify_password_submit").unbind("click").bind("click", function() {
        var data = $("#userModifyPasswordForm").serializeArray();//序列化表单
        $.ajax({
            type : "POST",
            contentType : "application/x-www-form-urlencoded",
            headers: {
                "Authorization": "Basic " + btoa(login_user + ":" + login_token)
            },
            url : "../restful/user/password",
            dataType : "json",
            data : data || "",
            success : function(data) {
                alert("Password update succeeded: " + JSON.stringify(data.payload));
            },
            error : function(jqXHR, textStatus, errorThrown) {
                alert("Password update failed, error: " + jqXHR.responseText);
            }
        });
    });

</script>

</body>
</html>
